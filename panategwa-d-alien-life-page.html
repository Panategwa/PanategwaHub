<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panategwa d - Alien Life</title>

<link rel="stylesheet" href="styles.css" />
<script src="menu-loader.js" defer></script>

</head>

<body>

<div id="menu-container"></div>

<h1>Panategwa d Taxonomy Explorer</h1>

<div id="current-rank"></div>
<div id="breadcrumbs"></div>

<button id="close-button">Close All</button>

<input type="text" id="search-bar" placeholder="Search any rank...">

<div id="search-results"></div>

<div id="current-title"></div>

<div id="info-box">Select a taxonomic rank to see info here.</div>

<div id="taxonomy-container"></div>

<script>
// ---------------- TAXONOMY DATA ----------------
const taxonomy = {
  Eukarya: {
    info: "Organisms whose cells have a nucleus.",
    Animalia: {
      info: "Multicellular heterotrophic organisms.",
      Chordata: {
        info: "Animals with a notochord.",
        Mammalia: {
          info: "Warm-blooded vertebrates with hair.",
          Primates: {
            info: "Large-brained mammals with forward-facing eyes.",
            Hominidae: {
              info: "Great apes and human-like species.",
              "Tri-Panategwaoi Anthropoi": {
                info: "Panategwan human-equivalent genus.",
                "Tri-Panategwaoi Anthropoi Civilis": {
                  info: `
<section>
  <h2>Physical Appearance</h2>
  <ul>
    <li>Average height: 2.5 m</li>
    <li>Six fingers, ambidextrous</li>
  </ul>
</section>
`,
                  Piton: { info: "Jungle-adapted subspecies." },
                  Rashton: { info: "Desert-adapted subspecies." },
                  Arifaton: { info: "Cold-region subspecies." }
                }
              }
            }
          }
        }
      }
    }
  }
};

// ---------------- STATE ----------------
let currentPath = [];
let currentNode = taxonomy;

// ---------------- RANK DEFINITIONS ----------------
const ranks = [
  "Domain",
  "Kingdom",
  "Phylum",
  "Class",
  "Order",
  "Family",
  "Genus",
  "Species",
  "Subspecies"
];

const childLabels = [
  "Domains",
  "Kingdoms",
  "Phyla",
  "Classes",
  "Orders",
  "Families",
  "Genera",
  "Species",
  "Subspecies"
];

function getRank(level) {
  return ranks[level] || "";
}

function getChildLabel(level) {
  return childLabels[level] || "";
}

// ---------------- RENDER ----------------
function renderLevel(node) {
  const container = document.getElementById("taxonomy-container");
  container.innerHTML = "";

  const level = currentPath.length;
  const label = getChildLabel(level);

  if (label) {
    const header = document.createElement("div");
    header.className = "section-label";
    header.textContent = label + ":";
    container.appendChild(header);
  }

  Object.keys(node).forEach(key => {
    if (key === "info") return;

    const btn = document.createElement("button");
    btn.textContent = key;

    btn.onclick = () => {
      currentPath.push(key);
      currentNode = node[key];
      renderLevel(currentNode);
      updateUI();
    };

    container.appendChild(btn);
  });
}

function updateUI() {
  const level = currentPath.length - 1;
  const name = currentPath[level] || "Domains";
  const rank = level >= 0 ? getRank(level) : "";

  document.getElementById("current-title").innerHTML =
    `<h2>${name}${rank ? ` <span class="taxonomy-type">(${rank})</span>` : ""}</h2>`;

  document.getElementById("breadcrumbs").textContent =
    currentPath.join(" > ");

  document.getElementById("current-rank").textContent =
    currentPath.map((_, i) => getRank(i)).join(" > ");

  document.getElementById("info-box").innerHTML =
    currentNode.info || "No info available.";
}

// ---------------- SEARCH ----------------
function findRanks(query, node = taxonomy, path = []) {
  let results = [];
  for (let key in node) {
    if (key === "info") continue;

    const newPath = [...path, key];

    if (key.toLowerCase().includes(query)) {
      results.push({ path: newPath, node: node[key] });
    }

    if (typeof node[key] === "object") {
      results = results.concat(findRanks(query, node[key], newPath));
    }
  }
  return results;
}

document.getElementById("search-bar").addEventListener("input", e => {
  const container = document.getElementById("search-results");
  container.innerHTML = "";

  const results = findRanks(e.target.value.toLowerCase());

  results.forEach(item => {
    const level = item.path.length - 1;

    const btn = document.createElement("button");
    btn.className = "sigma-button";
    btn.innerHTML = `
      <span class="search-main">
        ${item.path[level]}
        <span class="search-rank">(${getRank(level)})</span>
      </span>
      <span class="search-path">(${item.path.join(" > ")})</span>
    `;

    btn.onclick = () => {
      currentPath = item.path;
      currentNode = item.node;
      renderLevel(currentNode);
      updateUI();
      container.innerHTML = "";
      document.getElementById("search-bar").value = "";
    };

    container.appendChild(btn);
  });
});

document.getElementById("close-button").onclick = () => {
  currentPath = [];
  currentNode = taxonomy;
  renderLevel(currentNode);
  updateUI();
  document.getElementById("search-results").innerHTML = "";
  document.getElementById("search-bar").value = "";
};

// ---------------- START ----------------
renderLevel(currentNode);
updateUI();
</script>

</body>
</html>
